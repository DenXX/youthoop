"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{46:function(e,t,a){let s,r;var l=a(5893),n=a(7294),i=a(3977),o=a(9828);try{s=(0,i.ZF)({apiKey:"AIzaSyB5cOC37KgKYmVMjaeudqZHqThJnpHKt0I",authDomain:"youthoop-1a7b5.firebaseapp.com",projectId:"youthoop-1a7b5",storageBucket:"youthoop-1a7b5.firebasestorage.app",messagingSenderId:"999868782436",appId:"1:999868782436:web:e26324f00f88f4d3d24c71",measurementId:"G-MJY0TKNY69"}),r=(0,o.ad)(s)}catch(e){e.code}let d=e=>{let{filled:t,onMouseEnter:a,onClick:s,readOnly:r}=e;return(0,l.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:"transition-colors duration-150 ".concat(r?"cursor-default":"cursor-pointer"),onMouseEnter:a,onClick:s,children:(0,l.jsx)("path",{fill:t?"#FFD700":"#E0E0E0",d:"M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"})})},c=e=>{let{filled:t}=e;return(0,l.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{fill:t?"#FFD700":"#E0E0E0",d:"M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"})})};t.Z=e=>{let{teamId:t}=e,[a,s]=(0,n.useState)({avg:0,count:0,stars:{}}),[i,x]=(0,n.useState)([]),[h,u]=(0,n.useState)(!0),[g,m]=(0,n.useState)(!1),[y,f]=(0,n.useState)(0),[p,v]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[j,N]=(0,n.useState)(""),[S,E]=(0,n.useState)(!1),[k,I]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!t||!r)return;if(!/^[a-z0-9_-]+$/.test(t)){console.error("Invalid teamId format:",t),u(!1);return}let e=localStorage.getItem("voted_".concat(t));e&&v(!0);let a=async()=>{try{let e=(0,o.JU)(r,"ratings",t),a=await (0,o.QT)(e);if(a.exists()){let e=a.data();console.log("[RatingSystem] Fetched data for ".concat(t,":"),e);let r=e.stars||{},l=0,n=0;for(let[e,t]of Object.entries(r)){let a=parseInt(e),s=parseInt(t)||0;!isNaN(a)&&a>=1&&a<=5&&s>0&&(l+=a*s,n+=s)}let i=n>0?l/n:0;s({...e,avg:i,count:e.count||0,stars:r})}else console.log("[RatingSystem] No data for ".concat(t))}catch(e){console.error("Error fetching rating:",e)}finally{u(!1)}};a()},[t]);let M=async()=>{if(t&&!g&&!(i.length>0)){m(!0);try{let e=(0,o.hJ)(r,"ratings",t,"reviews"),a=(0,o.IO)(e,(0,o.Xo)("timestamp","desc"),(0,o.b9)(10)),s=await (0,o.PL)(a),l=[];s.forEach(e=>{l.push({id:e.id,...e.data()})}),x(l)}catch(e){console.error("Error fetching reviews:",e)}finally{m(!1)}}},C=async e=>{if(p)return;if(!e||e<1||e>5){console.error("Invalid rating value:",e);return}if(!t||"string"!=typeof t||!/^[a-z0-9_-]+$/.test(t)){console.error("Invalid teamId:",t);return}E(!0),f(e);let l={...a};l.count=(l.count||0)+1,l.stars={...l.stars};let n=String(e);l.stars[n]=(l.stars[n]||0)+1;let i=0,d=0;for(let[e,t]of Object.entries(l.stars)){let a=parseInt(e);!isNaN(a)&&a>=1&&a<=5&&(i+=a*t,d+=t)}l.avg=d>0?i/d:0,s(l);try{let a=o.EK.now(),s=(0,o.JU)(r,"ratings",t);await (0,o.pl)(s,{count:(0,o.nP)(1),stars:{[e]:(0,o.nP)(1)},last_updated:a},{merge:!0}),console.log("Vote submitted successfully: ".concat(e," stars for ").concat(t)),v(!0),localStorage.setItem("voted_".concat(t),"true"),w(!0)}catch(e){console.error("Vote failed:",e),s(a),f(0),alert("Failed to submit vote. Please try again.")}finally{E(!1)}},_=async()=>{if(!y||y<1||y>5){w(!1);return}let e=j.trim();if(!e){w(!1),N(""),f(0);return}if(e.length>500){alert("Review text must be 500 characters or less");return}E(!0);try{let a=o.EK.now(),s=(0,o.hJ)(r,"ratings",t,"reviews");await (0,o.ET)(s,{rating:y,text:e,timestamp:a,helpful_count:0}),x([{rating:y,text:e,timestamp:a,helpful_count:0},...i]),console.log("Review submitted successfully for ".concat(t)),w(!1),N(""),f(0)}catch(e){console.error("Review submission failed:",e),alert("Failed to submit review. Your vote was saved, but the review text couldn't be added.")}finally{E(!1)}},z=e=>{if(!e)return"";let t=e.toDate?e.toDate():new Date(e),a=new Date,s=Math.floor((a-t)/864e5);return 0===s?"Today":1===s?"Yesterday":s<7?"".concat(s," days ago"):s<30?"".concat(Math.floor(s/7)," weeks ago"):s<365?"".concat(Math.floor(s/30)," months ago"):t.toLocaleDateString()};if(h)return(0,l.jsx)("div",{className:"text-xs text-gray-400",children:"Loading..."});let D=a.count||0;return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center relative",children:[(0,l.jsxs)("div",{className:"flex cursor-pointer group",onMouseLeave:()=>!b&&f(0),children:[[1,2,3,4,5].map(e=>(0,l.jsx)(d,{filled:e<=(y||Math.round(a.avg)),onMouseEnter:()=>!p&&!b&&f(e),onClick:()=>C(e),readOnly:p||b},e)),!b&&(0,l.jsxs)("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white shadow-lg rounded-lg p-3 z-20 hidden group-hover:block border border-gray-100",children:[(0,l.jsx)("div",{className:"text-xs font-semibold mb-2 text-gray-700",children:"Rating Distribution"}),[5,4,3,2,1].map(e=>{let t=String(e),s=a.stars&&a.stars[t]||0;return(0,l.jsxs)("div",{className:"flex items-center text-xs mb-1",children:[(0,l.jsx)("span",{className:"w-3 text-gray-500 mr-1",children:e}),(0,l.jsx)("div",{className:"flex-1 h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,l.jsx)("div",{className:"h-full bg-yellow-400",style:{width:"".concat(D>0?s/D*100:0,"%")}})}),(0,l.jsx)("span",{className:"w-6 text-right text-gray-400 ml-1",children:s})]},e)})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500 ml-2",children:[(0,l.jsxs)("span",{children:[a.avg?a.avg.toFixed(1):"0.0"," (",D," ",1===D?"vote":"votes",")"]}),p&&(0,l.jsx)("span",{className:"text-green-600",children:"✓"}),D>0&&(0,l.jsxs)("div",{className:"relative group/reviews ml-1",onMouseEnter:()=>{k||(M(),I(!0))},children:[(0,l.jsx)("svg",{className:"w-4 h-4 text-gray-400 hover:text-gray-600 cursor-help",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,l.jsxs)("div",{className:"absolute top-full left-0 mt-2 w-80 bg-white shadow-xl rounded-lg p-4 z-50 hidden group-hover/reviews:block border border-gray-200",children:[(0,l.jsx)("div",{className:"text-sm font-semibold mb-3 text-gray-700 border-b pb-2",children:"Recent Reviews"}),(0,l.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:g?(0,l.jsx)("div",{className:"text-xs text-gray-400",children:"Loading reviews..."}):0===i.length?(0,l.jsx)("div",{className:"text-xs text-gray-400 italic",children:"No written reviews yet"}):i.map((e,t)=>(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-2 border border-gray-100",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,l.jsx)("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(t=>(0,l.jsx)(c,{filled:t<=e.rating},t))}),(0,l.jsx)("span",{className:"text-xs text-gray-400",children:z(e.timestamp)})]}),e.text&&(0,l.jsx)("p",{className:"text-xs text-gray-700 mt-1.5 whitespace-pre-wrap leading-relaxed",children:e.text})]},e.id||t))})]})]})]})]}),b&&p&&(0,l.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mt-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)("span",{className:"text-green-600 text-lg",children:"✓"}),(0,l.jsxs)("div",{className:"text-sm font-semibold text-gray-700",children:["Thanks! Your ",y,"-star rating has been saved."]})]}),(0,l.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:"Want to add a written review? (optional)"}),(0,l.jsx)("textarea",{placeholder:"Share your experience with this team...",value:j,onChange:e=>N(e.target.value),maxLength:500,className:"w-full text-sm border border-gray-300 rounded p-2 focus:outline-none focus:border-blue-500 resize-none",rows:3,disabled:S}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,l.jsxs)("span",{className:"text-xs text-gray-400",children:[j.length,"/500 characters"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>{w(!1),N(""),f(0)},disabled:S,className:"text-xs px-3 py-1 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Skip"}),(0,l.jsx)("button",{onClick:_,disabled:S||!j.trim(),className:"text-xs px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:bg-gray-400",children:S?"Submitting...":"Add Review"})]})]})]})]})}},6994:function(e,t){t.Z=[{area:"Seattle",x:420,y:130,dx:5,dy:-5},{area:"Seattle Eastside",x:440,y:140,dx:15,dy:0},{area:"South Seattle",x:420,y:150,dx:10,dy:10},{area:"Tacoma area",x:400,y:180,dx:15,dy:0},{area:"Everett Area",x:420,y:100,dx:15,dy:0},{area:"Kitsap",x:380,y:140,dx:-30,dy:-15},{area:"Bellingham Area",x:410,y:35,dx:15,dy:0},{area:"Olympia, Centralia Area",x:380,y:210,dx:-80,dy:15},{area:"Central Washington",x:580,y:220,dx:15,dy:0},{area:"Spokane and Eastern Washington",x:750,y:140,dx:-120,dy:20},{area:"Vancouver and Southwest Washington",x:400,y:320,dx:15,dy:0}]}}]);